let
    today_as_int = Int32.From(DateTime.LocalNow()),
    url = "https://api.spotify.com/v1/playlists/"&f_playlist_id&"/tracks?limit=100&offset=",
    Opts = [Headers=[Authorization=d_spotify_key],Timeout=#duration(0,0,5,0)],
    url11=url&"0",    s11=Web.Contents(url11,Opts), imp11=Json.Document(s11,65001), its11=imp11[items],
    itt11=Table.FromList(its11,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url12=url&"100",  s12=Web.Contents(url12,Opts), imp12=Json.Document(s12,65001), its12=imp12[items],
    itt12=Table.FromList(its12,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url13=url&"200",  s13=Web.Contents(url13,Opts), imp13=Json.Document(s13,65001), its13=imp13[items],
    itt13=Table.FromList(its13,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url14=url&"300",  s14=Web.Contents(url14,Opts), imp14=Json.Document(s14,65001), its14=imp14[items],
    itt14=Table.FromList(its14,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url15=url&"400",  s15=Web.Contents(url15,Opts), imp15=Json.Document(s15,65001), its15=imp15[items],
    itt15=Table.FromList(its15,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url16=url&"500",  s16=Web.Contents(url16,Opts), imp16=Json.Document(s16,65001), its16=imp16[items],
    itt16=Table.FromList(its16,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url17=url&"600",  s17=Web.Contents(url17,Opts), imp17=Json.Document(s17,65001), its17=imp17[items],
    itt17=Table.FromList(its17,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url18=url&"700",  s18=Web.Contents(url18,Opts), imp18=Json.Document(s18,65001), its18=imp18[items],
    itt18=Table.FromList(its18,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url19=url&"800",  s19=Web.Contents(url19,Opts), imp19=Json.Document(s19,65001), its19=imp19[items],
    itt19=Table.FromList(its19,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url20=url&"900",  s20=Web.Contents(url20,Opts), imp20=Json.Document(s20,65001), its20=imp20[items],
    itt20=Table.FromList(its20,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url21=url&"1000", s21=Web.Contents(url21,Opts), imp21=Json.Document(s21,65001), its21=imp21[items],
    itt21=Table.FromList(its21,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url22=url&"1100", s22=Web.Contents(url22,Opts), imp22=Json.Document(s22,65001), its22=imp22[items],
    itt22=Table.FromList(its22,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url23=url&"1200", s23=Web.Contents(url23,Opts), imp23=Json.Document(s23,65001), its23=imp23[items],
    itt23=Table.FromList(its23,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url24=url&"1300", s24=Web.Contents(url24,Opts), imp24=Json.Document(s24,65001), its24=imp24[items],
    itt24=Table.FromList(its24,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url25=url&"1400", s25=Web.Contents(url25,Opts), imp25=Json.Document(s25,65001), its25=imp25[items],
    itt25=Table.FromList(its25,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url26=url&"1500", s26=Web.Contents(url26,Opts), imp26=Json.Document(s26,65001), its26=imp26[items],
    itt26=Table.FromList(its26,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url27=url&"1600", s27=Web.Contents(url27,Opts), imp27=Json.Document(s27,65001), its27=imp27[items],
    itt27=Table.FromList(its27,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url28=url&"1700", s28=Web.Contents(url28,Opts), imp28=Json.Document(s28,65001), its28=imp28[items],
    itt28=Table.FromList(its28,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url29=url&"1800", s29=Web.Contents(url29,Opts), imp29=Json.Document(s29,65001), its29=imp29[items],
    itt29=Table.FromList(its29,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url30=url&"1900", s30=Web.Contents(url30,Opts), imp30=Json.Document(s30,65001), its30=imp30[items],
    itt30=Table.FromList(its30,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url31=url&"2000", s31=Web.Contents(url31,Opts), imp31=Json.Document(s31,65001), its31=imp31[items],
    itt31=Table.FromList(its31,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url32=url&"2100", s32=Web.Contents(url32,Opts), imp32=Json.Document(s32,65001), its32=imp32[items],
    itt32=Table.FromList(its32,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url33=url&"2200", s33=Web.Contents(url33,Opts), imp33=Json.Document(s33,65001), its33=imp33[items],
    itt33=Table.FromList(its33,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url34=url&"2300", s34=Web.Contents(url34,Opts), imp34=Json.Document(s34,65001), its34=imp34[items],
    itt34=Table.FromList(its34,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url35=url&"2400", s35=Web.Contents(url35,Opts), imp35=Json.Document(s35,65001), its35=imp35[items],
    itt35=Table.FromList(its35,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url36=url&"2500", s36=Web.Contents(url36,Opts), imp36=Json.Document(s36,65001), its36=imp36[items],
    itt36=Table.FromList(its36,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url37=url&"2600", s37=Web.Contents(url37,Opts), imp37=Json.Document(s37,65001), its37=imp37[items],
    itt37=Table.FromList(its37,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url38=url&"2700", s38=Web.Contents(url38,Opts), imp38=Json.Document(s38,65001), its38=imp38[items],
    itt38=Table.FromList(its38,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url39=url&"2800", s39=Web.Contents(url39,Opts), imp39=Json.Document(s39,65001), its39=imp39[items],
    itt39=Table.FromList(its39,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url40=url&"2900", s40=Web.Contents(url40,Opts), imp40=Json.Document(s40,65001), its40=imp40[items],
    itt40=Table.FromList(its40,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url41=url&"3000", s41=Web.Contents(url41,Opts), imp41=Json.Document(s41,65001), its41=imp41[items],
    itt41=Table.FromList(its41,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url42=url&"3100", s42=Web.Contents(url42,Opts), imp42=Json.Document(s42,65001), its42=imp42[items],
    itt42=Table.FromList(its42,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url43=url&"3200", s43=Web.Contents(url43,Opts), imp43=Json.Document(s43,65001), its43=imp43[items],
    itt43=Table.FromList(its43,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url44=url&"3300", s44=Web.Contents(url44,Opts), imp44=Json.Document(s44,65001), its44=imp44[items],
    itt44=Table.FromList(its44,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url45=url&"3400", s45=Web.Contents(url45,Opts), imp45=Json.Document(s45,65001), its45=imp45[items],
    itt45=Table.FromList(its45,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url46=url&"3500", s46=Web.Contents(url46,Opts), imp46=Json.Document(s46,65001), its46=imp46[items],
    itt46=Table.FromList(its46,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url47=url&"3600", s47=Web.Contents(url47,Opts), imp47=Json.Document(s47,65001), its47=imp47[items],
    itt47=Table.FromList(its47,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url48=url&"3700", s48=Web.Contents(url48,Opts), imp48=Json.Document(s48,65001), its48=imp48[items],
    itt48=Table.FromList(its48,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url49=url&"3800", s49=Web.Contents(url49,Opts), imp49=Json.Document(s49,65001), its49=imp49[items],
    itt49=Table.FromList(its49,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url50=url&"3900", s50=Web.Contents(url50,Opts), imp50=Json.Document(s50,65001), its50=imp50[items],
    itt50=Table.FromList(its50,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url51=url&"4000", s51=Web.Contents(url51,Opts), imp51=Json.Document(s51,65001), its51=imp51[items],
    itt51=Table.FromList(its51,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url52=url&"4100", s52=Web.Contents(url52,Opts), imp52=Json.Document(s52,65001), its52=imp52[items],
    itt52=Table.FromList(its52,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url53=url&"4200", s53=Web.Contents(url53,Opts), imp53=Json.Document(s53,65001), its53=imp53[items],
    itt53=Table.FromList(its53,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url54=url&"4300", s54=Web.Contents(url54,Opts), imp54=Json.Document(s54,65001), its54=imp54[items],
    itt54=Table.FromList(its54,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url55=url&"4400", s55=Web.Contents(url55,Opts), imp55=Json.Document(s55,65001), its55=imp55[items],
    itt55=Table.FromList(its55,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url56=url&"4500", s56=Web.Contents(url56,Opts), imp56=Json.Document(s56,65001), its56=imp56[items],
    itt56=Table.FromList(its56,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    url57=url&"4600", s57=Web.Contents(url57,Opts), imp57=Json.Document(s57,65001), its57=imp57[items],
    itt57=Table.FromList(its57,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    //url58=url&"4700", s58=Web.Contents(url58,Opts), imp58=Json.Document(s58,65001), its58=imp58[items],
    //itt58=Table.FromList(its58,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    //url59=url&"4800", s59=Web.Contents(url59,Opts), imp59=Json.Document(s59,65001), its59=imp59[items],
    //itt59=Table.FromList(its59,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    queries = Table.Combine({
      itt11, itt12, itt13, itt14, itt15, itt16, itt17, itt18, itt19, itt20, itt21, itt22, itt23, itt24,
      itt25, itt26, itt27, itt28, itt29, itt30, itt31, itt32, itt33, itt34, itt35, itt36, itt37, itt38,
      itt39, itt40, itt41, itt42, itt43, itt44, itt45, itt46, itt47, itt48, itt49, itt50, itt51, itt52,
      itt53, itt54, itt55, itt56, itt57
    }),
    expand_columns = Table.ExpandRecordColumn(
        queries, "Column1", {/*"added_by", */"track"}, {/*"added_by", */"track"}
    ),
    expand_track = Table.ExpandRecordColumn(expand_columns, "track", {
        "album", "artists", "disc_number", "duration_ms", "id",       "name", "popularity", "track_number"
    }, {
        "album", "artists", "disc_number", "duration",    "id_track", "song", "popularity", "track_number"
    }),
    expand_album = Table.ExpandRecordColumn(
        expand_track, "album", {"id", "name", "release_date"}, {"id_album", "album", "release_date"}
    ),
    expand_artist = Table.ExpandListColumn(expand_album, "artists"),
    expand_artist_children = Table.ExpandRecordColumn(
        expand_artist, "artists", {"id", "name"}, {"id_artists", "artist"}
    ),
    sort_cols = Table.ReorderColumns(expand_artist_children,{
        "release_date", "artist", "song", "duration", "popularity", "disc_number",
        "id_artists", "album", "id_album", "track_number", "id_track"
    }),
    type_cols = Table.TransformColumnTypes(sort_cols,{
        {"release_date", type date}, {"artist", type text}, {"song", type text}, {"duration", Int64.Type},
        {"popularity", Int64.Type}, {"disc_number", Int64.Type}, {"id_artists", type text}, {"album", type text},
        {"id_album", type text}, {"track_number", Int64.Type}, {"id_track", type text}}
    ),
    ms_to_s = Table.TransformColumns(type_cols, {{"duration", each _ / 1000, type number}}),
    date_as_int = Table.DuplicateColumn(ms_to_s, "release_date", "release_date_as_int"),
    release_date_as_int_typing = Table.TransformColumnTypes(date_as_int,{{"release_date_as_int", Int64.Type}}),
    get_years_ago = Table.AddColumn(
        release_date_as_int_typing, "years_ago", each (today_as_int - [release_date_as_int])/365, type number
    ),
    del_unused_cols = Table.RemoveColumns(get_years_ago,{"release_date_as_int"}),
    add_index = Table.AddIndexColumn(del_unused_cols, "index", 1, 1, Int64.Type)
in
    add_index